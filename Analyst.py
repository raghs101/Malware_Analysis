import angr
import monkeyhex
import networkx
from angrutils import *
from file_info import File_Analysis


class Angr_Analysis:
    def __init__(self,file_path):
        self.file_path = file_path
        self.p = angr.Project(self.file_path, load_options={'auto_load_libs': False})
    def cfg_fast(self):
        return self.p.analyses.CFGFast()
    def full_cfg(self):
        cs = File_Analysis(self.file_path)
        file = cs.get_name()
        cfg = self.p.analyses.CFGEmulated(keep_state=True)
        plot_cfg(cfg, f"static/{file}", asminst=True, remove_imports=True, remove_path_terminator=True)


cs = Angr_Analysis("static/vuln")
cs.full_cfg()